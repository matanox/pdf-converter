// Generated by CoffeeScript 1.6.3
var fs, winston, winstonWrite, writers;

fs = require('fs');

winston = require('winston');

writers = {};

winstonWrite = function(writer, data) {
  return writer.info(data);
};

exports.write = function(inputFileName, dataType, data) {
  var err, nameBase, now, writer;
  if (writers[dataType] != null) {
    return winstonWrite(writers[dataType], data);
  } else {
    writer = new winston.Logger;
    now = new Date();
    try {
      fs.mkdirSync('docData/' + inputFileName);
    } catch (_error) {
      err = _error;
      if (err.code !== 'EEXIST') {
        throw e;
      }
    }
    nameBase = 'docData/' + inputFileName + '/' + dataType + '-' + now.toISOString() + '.out';
    writer = new winston.Logger({
      transports: [
        new winston.transports.File({
          name: 'file#json',
          filename: nameBase + '.json',
          json: true,
          timestamp: false
        }), new winston.transports.File({
          name: 'file#text',
          filename: nameBase,
          json: false,
          timestamp: false
        })
      ],
      exitOnError: false
    });
    console.log("Data writing for " + inputFileName + ", " + dataType + " is going to " + nameBase);
    return writers[dataType] = writer;
  }
};

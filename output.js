// Generated by CoffeeScript 1.6.3
var hookElementTextPos, hookId, outputTemplate;

require("fs");

outputTemplate = fs.readFileSync('outputTemplate/index.html').toString();

hookId = 'hookPoint';

hookElementTextPos = outputTemplate.indexOf(">", outputTemplate.indexOf('<span id="' + hookId + '"')) + 1;

exports.serveOutput = function(html, name, res) {
  var outputFile, outputHtml;
  outputFile = '../local-copies/' + 'output/' + name + '.html';
  outputHtml = outputTemplate.slice(0, hookElementTextPos).concat(html, outputTemplate.slice(hookElementTextPos));
  util.timelog('Saving serialized output to file');
  return fs.writeFile(outputFile, outputHtml, function(err) {
    if (err != null) {
      res.send(500);
      throw err;
    }
    util.timelog('Saving serialized output to file');
    console.log('Sending response....');
    return res.sendfile(name + '.html', {
      root: '../local-copies/' + 'output/'
    });
  });
};
